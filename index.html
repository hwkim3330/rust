<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>Insertion Sort – Smooth Animation</title>
<style>
  :root { --gap: 12px; --box: 70px; --bg: #2f4858; --key: #e63946; --duration: .5s; }

  body      { margin:0; font-family:system-ui, sans-serif; background:#f0f2f5; }
  h1        { text-align:center; margin:30px 0 10px; }
  #wrap     { display:flex; flex-wrap:wrap; width:calc(var(--box)*4 + var(--gap)*3);
              margin:40px auto; gap:var(--gap); justify-content:center; }
  .cell     { width:var(--box); height:var(--box); line-height:var(--box);
              background:var(--bg); color:#fff; border-radius:12px;
              font-size:1.5rem; text-align:center; position:relative;
              transition:transform var(--duration) cubic-bezier(.4,.0,.2,1),
                         background var(--duration); }
  .key      { background:var(--key) !important; }

  #log      { max-width:640px; margin:30px auto; font-size:.9rem; white-space:pre-line; }
</style>
</head>
<body>
<h1>Insertion Sort Visualization</h1>
<div id="wrap"></div>
<pre id="log"></pre>

<script>
/* ---------- 설정 값 ---------- */
const DATA  = [5, 2, 9, 1, 5, 6]; // 정렬 대상
const SPEED = 700;                // 단계 지연(ms)

/* ---------- DOM 초기화 ---------- */
const wrap = document.getElementById('wrap');
const log  = document.getElementById('log');

function render(arr){              // 박스 새로 그리기
  wrap.innerHTML = '';
  arr.forEach(v=>{
    const d = document.createElement('div');
    d.className = 'cell';
    d.textContent = v;
    wrap.appendChild(d);
  });
}
render(DATA);

/* ---------- 유틸 ---------- */
const pause = ms => new Promise(r=>setTimeout(r,ms));

/* ---------- 핵심 애니메이션 ---------- */
async function insertionSortVis(arr){
  const cells = ()=>[...document.querySelectorAll('.cell')];

  for(let i=1;i<arr.length;i++){
    const keyVal = arr[i];
    let j=i-1;

    cells()[i].classList.add('key');      // key 강조
    log.textContent += `[i=${i}] key=${keyVal}\n`;
    await pause(SPEED/2);

    // 뒤로 밀어내기
    while(j>=0 && arr[j] > keyVal){
      arr[j+1] = arr[j];                  // 값 이동
      // 애니메이션: 왼쪽 박스를 아래-오른쪽으로 부드럽게 이동
      cells()[j].style.transform =
        `translate(calc(var(--box)+var(--gap)), var(--box) )`;
      await pause(SPEED);

      /* DOM 재배치 */
      wrap.insertBefore(cells()[j], cells()[j+2]);
      cells()[j].style.transform = '';    // 원위치(transition으로 자연 복귀)
      j--;
    }

    /* key 삽입 */
    arr[j+1] = keyVal;
    const keyBox = cells().find(c=>c.classList.contains('key'));
    wrap.insertBefore(keyBox, cells()[j+1]);
    keyBox.classList.remove('key');
    await pause(SPEED);
  }
  log.textContent += `\n✔ 최종 결과: [${arr.join(', ')}]`;
}

insertionSortVis([...DATA]);              // 원본 보호를 위해 복사 전달
</script>
</body>
</html>
